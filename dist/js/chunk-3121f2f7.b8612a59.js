(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3121f2f7"],{"0531":function(t,e,n){},"08c4":function(t,e,n){"use strict";var o=n("a026");function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return(e=l(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){var e=c(t,"string");return"symbol"==i(e)?e:e+""}function c(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=i(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}e["a"]={data:function(){return{vueFormatters:[]}},methods:{vueFormatter:function(t){var e="_vue_formatter_".concat(this.vueFormatters.length);return this.vueFormatters.push(r({el:".".concat(e),name:e},t)),'<div class="'.concat(e,'"/>')},vueFormatterInit:function(){if(this.vueFormatters.length)for(var t=this.vueFormatters.length-1;t>=0;t--){var e=this.vueFormatters[t];document.getElementsByClassName(e.name)&&(new o["default"](e),this.vueFormatters.splice(t,1))}}}}},"2f0e":function(t,e,n){"use strict";var o=function(){var t=this,e=t._self._c;return e("b-button",{attrs:{pressed:t.toggle,variant:t.variant},on:{"update:pressed":function(e){t.toggle=e},click:function(e){return t.$emit("toggle")}}},[e("i",{class:t.iconClass}),t._v(" "+t._s(t.label))])},i=[],a={props:{variant:String,label:String},computed:{iconClass:function(){return!0===this.toggle?"fa fa-chevron-up":"fa fa-chevron-down"}},data:function(){return{toggle:!1}}},r=a,s=n("2877"),l=Object(s["a"])(r,o,i,!1,null,null,null);e["a"]=l.exports},"30a6":function(t,e,n){"use strict";n("8b7e")},"3acd":function(t,e,n){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",[t.showPlaceholderLabel?e("label",{staticClass:"d-block"},[t._v(" ")]):t._e(),e("b-form-group",{attrs:{id:t.id,label:t.currentLabel,"label-for":"".concat(t.id,"-input"),"content-cols":"auto"}},[e("b-input-group",{class:t.inputGroupSize},[e("c-switch",t._g(t._b({directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{id:"".concat(t.id,"-input"),color:"primary",label:"",readonly:t.readonly,disabled:t.disabled,title:t.tooltip},model:{value:t.innerValue,callback:function(e){t.innerValue=e},expression:"innerValue"}},"c-switch",t.labelIcon,!1),t.inputListeners))],1)],1)],1)},i=[],a=n("900c"),r=n("f1fb"),s={components:{cSwitch:r["o"]},props:{id:String,label:String,labelOn:String,labelOff:String,value:Boolean,inputGroupSize:String,readonly:Boolean,disabled:Boolean,showPlaceholderLabel:Boolean,tooltip:String},data:function(){return{labelIcon:{dataOn:"✓",dataOff:"✕"},currentLabel:(this.value?this.labelOn:this.labelOff)||this.label}},computed:{innerValue:{get:function(){return a["a"].toBoolean(this.value)},set:function(t){return this.currentLabel=(t?this.labelOn:this.labelOff)||this.label,a["a"].toBoolean(t)}},inputListeners:function(){var t=this;return Object.assign({},this.$listeners,{change:function(e){t.$emit("input",e),t.$emit("change",e)}})}},methods:{}},l=s,c=(n("710c"),n("2877")),u=Object(c["a"])(l,o,i,!1,null,"7630b63a",null);e["a"]=u.exports},6397:function(t,e){t.exports=function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),i=function(t){return t&&t.__esModule?t:{default:t}}(o);jQuery().bootstrapToggle||n(4);var a={};e.default={defaults:a,props:{value:Boolean,options:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1}},data:function(){return{updating:!1}},computed:{$$el:function(){return jQuery(this.$el)}},watch:{value:function(t){this.updating||this.$$el.bootstrapToggle(t?"on":"off")},disabled:function(t){this.$$el.bootstrapToggle(t?"disable":"enable")}},mounted:function(){var t=this;this.value&&(this.$el.checked=!0),this.$$el.bootstrapToggle(i.default.recursive(!0,a,this.options)),this.disabled&&this.$$el.bootstrapToggle("disable"),this.$$el.change((function(){t.updating=!0,t.$emit("input",t.$$el.prop("checked")),t.$nextTick((function(){return t.updating=!1}))}))},beforeDestroy:function(){this.$$el.bootstrapToggle("destroy"),this.$$el.off("change")}}},function(t,e){t.exports=function(t,e,n,o){var i,a=t=t||{},r=typeof t.default;"object"!==r&&"function"!==r||(i=t,a=t.default);var s="function"==typeof a?a.options:a;if(e&&(s.render=e.render,s.staticRenderFns=e.staticRenderFns),n&&(s._scopeId=n),o){var l=Object.create(s.computed||null);Object.keys(o).forEach((function(t){var e=o[t];l[t]=function(){return e}})),s.computed=l}return{esModule:i,exports:a,options:s}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{attrs:{type:"checkbox"}})},staticRenderFns:[]}},function(t,e,n){var o=n(5);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals),n(9)("837c61fc",o,!0)},function(t,e){
/*! ========================================================================
 * Bootstrap Toggle: bootstrap-toggle.js v2.2.0
 * http://www.bootstraptoggle.com
 * ========================================================================
 * Copyright 2014 Min Hur, The New York Times Company
 * Licensed under MIT
 * ======================================================================== */
!function(t){"use strict";function e(e){return this.each((function(){var o=t(this),i=o.data("bs.toggle"),a="object"==typeof e&&e;i||o.data("bs.toggle",i=new n(this,a)),"string"==typeof e&&i[e]&&i[e]()}))}var n=function(e,n){this.$element=t(e),this.options=t.extend({},this.defaults(),n),this.render()};n.VERSION="2.2.0",n.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"normal",style:"",width:null,height:null},n.prototype.defaults=function(){return{on:this.$element.attr("data-on")||n.DEFAULTS.on,off:this.$element.attr("data-off")||n.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||n.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||n.DEFAULTS.offstyle,size:this.$element.attr("data-size")||n.DEFAULTS.size,style:this.$element.attr("data-style")||n.DEFAULTS.style,width:this.$element.attr("data-width")||n.DEFAULTS.width,height:this.$element.attr("data-height")||n.DEFAULTS.height}},n.prototype.render=function(){this._onstyle="btn-"+this.options.onstyle,this._offstyle="btn-"+this.options.offstyle;var e="large"===this.options.size?"btn-lg":"small"===this.options.size?"btn-sm":"mini"===this.options.size?"btn-xs":"",n=t('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+e),o=t('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+e+" active"),i=t('<span class="toggle-handle btn btn-default">').addClass(e),a=t('<div class="toggle-group">').append(n,o,i),r=t('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(e).addClass(this.options.style);this.$element.wrap(r),t.extend(this,{$toggle:this.$element.parent(),$toggleOn:n,$toggleOff:o,$toggleGroup:a}),this.$toggle.append(a);var s=this.options.width||Math.max(n.outerWidth(),o.outerWidth())+i.outerWidth()/2,l=this.options.height||Math.max(n.outerHeight(),o.outerHeight());n.addClass("toggle-on"),o.addClass("toggle-off"),this.$toggle.css({width:s,height:l}),this.options.height&&(n.css("line-height",n.height()+"px"),o.css("line-height",o.height()+"px")),this.update(!0),this.trigger(!0)},n.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()},n.prototype.on=function(t){if(this.$element.prop("disabled"))return!1;this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle),this.$element.prop("checked",!0),t||this.trigger()},n.prototype.off=function(t){if(this.$element.prop("disabled"))return!1;this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off"),this.$element.prop("checked",!1),t||this.trigger()},n.prototype.enable=function(){this.$toggle.removeAttr("disabled"),this.$element.prop("disabled",!1)},n.prototype.disable=function(){this.$toggle.attr("disabled","disabled"),this.$element.prop("disabled",!0)},n.prototype.update=function(t){this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked")?this.on(t):this.off(t)},n.prototype.trigger=function(e){this.$element.off("change.bs.toggle"),e||this.$element.change(),this.$element.on("change.bs.toggle",t.proxy((function(){this.update()}),this))},n.prototype.destroy=function(){this.$element.off("change.bs.toggle"),this.$toggleGroup.remove(),this.$element.removeData("bs.toggle"),this.$element.unwrap()};var o=t.fn.bootstrapToggle;t.fn.bootstrapToggle=e,t.fn.bootstrapToggle.Constructor=n,t.fn.toggle.noConflict=function(){return t.fn.bootstrapToggle=o,this},t((function(){t("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()})),t(document).on("click.bs.toggle","div[data-toggle^=toggle]",(function(e){t(this).find("input[type=checkbox]").bootstrapToggle("toggle"),e.preventDefault()}))}(jQuery)},function(t,e,n){e=t.exports=n(6)(),e.push([t.i,"/*! ========================================================================\n * Bootstrap Toggle: bootstrap-toggle.css v2.2.0\n * http://www.bootstraptoggle.com\n * ========================================================================\n * Copyright 2014 Min Hur, The New York Times Company\n * Licensed under MIT\n * ======================================================================== */.checkbox-inline .toggle,.checkbox label .toggle{margin-left:-20px;margin-right:5px}.toggle{position:relative;overflow:hidden}.toggle input[type=checkbox]{display:none}.toggle-group{position:absolute;width:200%;top:0;bottom:0;left:0;transition:left .35s;-webkit-transition:left .35s;-moz-user-select:none;-webkit-user-select:none}.toggle.off .toggle-group{left:-100%}.toggle-on{left:0;right:50%}.toggle-off,.toggle-on{position:absolute;top:0;bottom:0;margin:0;border:0;border-radius:0}.toggle-off{left:50%;right:0}.toggle-handle{position:relative;margin:0 auto;padding-top:0;padding-bottom:0;height:100%;width:0;border-width:0 1px}.toggle.btn{min-width:59px;min-height:34px}.toggle-on.btn{padding-right:24px}.toggle-off.btn{padding-left:24px}.toggle.btn-lg{min-width:79px;min-height:45px}.toggle-on.btn-lg{padding-right:31px}.toggle-off.btn-lg{padding-left:31px}.toggle-handle.btn-lg{width:40px}.toggle.btn-sm{min-width:50px;min-height:30px}.toggle-on.btn-sm{padding-right:20px}.toggle-off.btn-sm{padding-left:20px}.toggle.btn-xs{min-width:35px;min-height:22px}.toggle-on.btn-xs{padding-right:12px}.toggle-off.btn-xs{padding-left:12px}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(o[a]=!0)}for(i=0;i<e.length;i++){var r=e[i];"number"==typeof r[0]&&o[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),t.push(r))}},t}},function(t,e,n){(function(t){!function(e){function n(t,e){if("object"!==i(t))return e;for(var o in e)"object"===i(t[o])&&"object"===i(e[o])?t[o]=n(t[o],e[o]):t[o]=e[o];return t}function o(t,e,o){var r=o[0],s=o.length;(t||"object"!==i(r))&&(r={});for(var l=0;l<s;++l){var c=o[l];if("object"===i(c))for(var u in c){var d=t?a.clone(c[u]):c[u];r[u]=e?n(r[u],d):d}}return r}function i(t){return{}.toString.call(t).slice(8,-1).toLowerCase()}var a=function(t){return o(!0===t,!1,arguments)};a.recursive=function(t){return o(!0===t,!0,arguments)},a.clone=function(t){var e,n,o=t,r=i(t);if("array"===r)for(o=[],n=t.length,e=0;e<n;++e)o[e]=a.clone(t[e]);else if("object"===r)for(e in o={},t)o[e]=a.clone(t[e]);return o},e?t.exports=a:window.merge=a}("object"==typeof t&&t&&"object"==typeof t.exports&&t.exports)}).call(e,n(11)(t))},function(t,e,n){n(3);var o=n(1)(n(0),n(2),null,null);t.exports=o.exports},function(t,e,n){function o(t){for(var e=0;e<t.length;e++){var n=t[e],o=u[n.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](n.parts[i]);for(;i<n.parts.length;i++)o.parts.push(a(n.parts[i]));o.parts.length>n.parts.length&&(o.parts.length=n.parts.length)}else{var r=[];for(i=0;i<n.parts.length;i++)r.push(a(n.parts[i]));u[n.id]={id:n.id,refs:1,parts:r}}}}function i(){var t=document.createElement("style");return t.type="text/css",d.appendChild(t),t}function a(t){var e,n,o=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(o){if(h)return m;o.parentNode.removeChild(o)}if(b){var a=f++;o=p||(p=i()),e=r.bind(null,o,a,!1),n=r.bind(null,o,a,!0)}else o=i(),e=s.bind(null,o),n=function(){o.parentNode.removeChild(o)};return e(t),function(o){if(o){if(o.css===t.css&&o.media===t.media&&o.sourceMap===t.sourceMap)return;e(t=o)}else n()}}function r(t,e,n,o){var i=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=g(e,i);else{var a=document.createTextNode(i),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(a,r[e]):t.appendChild(a)}}function s(t,e){var n=e.css,o=e.media,i=e.sourceMap;if(o&&t.setAttribute("media",o),i&&(n+="\n/*# sourceURL="+i.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c=n(10),u={},d=l&&(document.head||document.getElementsByTagName("head")[0]),p=null,f=0,h=!1,m=function(){},b="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,n){h=n;var i=c(t,e);return o(i),function(e){for(var n=[],a=0;a<i.length;a++){var r=i[a],s=u[r.id];s.refs--,n.push(s)}e?(i=c(t,e),o(i)):i=[];for(a=0;a<n.length;a++){s=n[a];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete u[s.id]}}}};var g=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t,e){for(var n=[],o={},i=0;i<e.length;i++){var a=e[i],r=a[0],s=a[1],l=a[2],c=a[3],u={id:t+":"+i,css:s,media:l,sourceMap:c};o[r]?o[r].parts.push(u):n.push(o[r]={id:r,parts:[u]})}return n}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}}])},"6b0c":function(t,e,n){"use strict";e["a"]={methods:{setSearchTextQuery:function(t){var e=JSON.parse(JSON.stringify(this.$route.query));""===t?delete e.searchText:e.searchText=t,this.$router.replace({query:e})}}}},"710c":function(t,e,n){"use strict";n("0531")},7151:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"permission",rawName:"v-permission:or",value:[t.PERMISSIONS.POLICY_MANAGEMENT,t.PERMISSIONS.POLICY_MANAGEMENT_CREATE,t.PERMISSIONS.POLICY_MANAGEMENT_READ,t.PERMISSIONS.POLICY_MANAGEMENT_UPDATE,t.PERMISSIONS.POLICY_MANAGEMENT_DELETE],expression:"[\n    PERMISSIONS.POLICY_MANAGEMENT,\n    PERMISSIONS.POLICY_MANAGEMENT_CREATE,\n    PERMISSIONS.POLICY_MANAGEMENT_READ,\n    PERMISSIONS.POLICY_MANAGEMENT_UPDATE,\n    PERMISSIONS.POLICY_MANAGEMENT_DELETE,\n  ]",arg:"or"}],staticClass:"animated fadeIn"},[e("b-tabs",{staticClass:"body-bg-color",staticStyle:{"border-left":"0","border-right":"0","border-top":"0"}},[e("b-tab",{ref:"policies",staticClass:"body-bg-color overview-chart",staticStyle:{"border-left":"0","border-right":"0","border-top":"0"},attrs:{active:""},on:{click:function(e){return t.routeTo()}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-list-alt"}),t._v(" "+t._s(t.$t("message.policies"))+"\n        "),e("b-badge",{attrs:{variant:"tab-total"}},[t._v(t._s(t.totalPolicies))])]},proxy:!0}])},[e("policy-list",{on:{total:function(e){t.totalPolicies=e}}})],1),e("b-tab",{ref:"licensegroups",on:{click:function(e){return t.routeTo("licenseGroups")}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-balance-scale"}),t._v("\n        "+t._s(t.$t("message.license_groups"))+"\n        "),e("b-badge",{attrs:{variant:"tab-total"}},[t._v(t._s(t.totalLicenseGroups))])]},proxy:!0}])},[e("license-group-list",{on:{total:function(e){t.totalLicenseGroups=e}}})],1),e("b-tab",{ref:"vulnerability",staticClass:"body-bg-color overview-chart",staticStyle:{"border-left":"0","border-right":"0","border-top":"0"},on:{click:function(e){return t.routeTo("vulnerability")}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-list-alt"}),t._v("\n        "+t._s(t.$t("message.vulnerability_policies"))+"\n        "),e("b-badge",{attrs:{variant:"tab-total"}},[t._v(t._s(t.totalVulnerabilityPolicies))])]},proxy:!0}])},[e("vulnerability-policy-list",{on:{total:function(e){t.totalVulnerabilityPolicies=e}}})],1)],1)],1)},i=[],a=n("7c15"),r=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"permission",rawName:"v-permission:or",value:["POLICY_MANAGEMENT","POLICY_MANAGEMENT_CREATE","POLICY_MANAGEMENT_READ","POLICY_MANAGEMENT_UPDATE","POLICY_MANAGEMENT_DELETE"],expression:"[\n    'POLICY_MANAGEMENT',\n    'POLICY_MANAGEMENT_CREATE',\n    'POLICY_MANAGEMENT_READ',\n    'POLICY_MANAGEMENT_UPDATE',\n    'POLICY_MANAGEMENT_DELETE',\n  ]",arg:"or"}],staticClass:"animated fadeIn"},[e("div",{staticClass:"bs-table-custom-toolbar",attrs:{id:"policiesToolbar"}},[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.createPolicyModal",modifiers:{createPolicyModal:!0}},{name:"permission",rawName:"v-permission:or",value:[t.PERMISSIONS.POLICY_MANAGEMENT,t.PERMISSIONS.POLICY_MANAGEMENT_CREATE],expression:"[\n        PERMISSIONS.POLICY_MANAGEMENT,\n        PERMISSIONS.POLICY_MANAGEMENT_CREATE,\n      ]",arg:"or"}],attrs:{size:"md",variant:"outline-primary"}},[e("span",{staticClass:"fa fa-plus"}),t._v(" "+t._s(t.$t("message.create_policy"))+"\n    ")])],1),e("bootstrap-table",{ref:"table",attrs:{columns:t.columns,data:t.data,options:t.options},on:{"on-load-success":t.tableLoaded}}),e("create-policy-modal",{on:{refreshTable:t.refreshTable}})],1)},s=[],l=n("900c"),c=n("6c36"),u=n.n(c),d=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"createPolicyModal",size:"md","hide-header-close":"","no-stacking":"",title:t.$t("message.create_policy")},on:{hide:function(e){return t.resetValues()}},scopedSlots:t._u([{key:"modal-footer",fn:function(n){var o=n.cancel;return[e("b-button",{attrs:{size:"md",variant:"secondary"},on:{click:function(t){return o()}}},[t._v(t._s(t.$t("message.close")))]),e("b-button",{attrs:{size:"md",variant:"primary"},on:{click:function(e){return t.createPolicy()}}},[t._v(t._s(t.$t("message.create")))])]}}])},[e("b-validated-input-group-form-input",{attrs:{id:"identifier",label:this.$t("message.name"),"input-group-size":"mb-3",rules:"required"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)},p=[],f=n("cc9d"),h={name:"createPolicyModal",mixins:[a["a"]],components:{BValidatedInputGroupFormInput:f["a"]},data:function(){return{name:null}},methods:{createPolicy:function(){var t=this,e="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY);this.axios.put(e,{name:this.name}).then((function(e){t.$root.$emit("bv::hide::modal","createPolicyModal"),t.$emit("refreshTable"),t.$toastr.s(t.$t("message.policy_created"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))})).finally((function(){t.resetValues()}))},resetValues:function(){this.name=null}}},m=h,b=n("2877"),g=Object(b["a"])(m,d,p,!1,null,null,null),v=g.exports,y=n("6b0c"),E=n("12cb"),_=n("e68f"),S=n("192b"),I=n("f547"),N=n("08c4"),A=n("41c0"),O=function(){var t=this,e=t._self._c;return e("actionable-list-group-item",{directives:[{name:"permission",rawName:"v-permission:or",value:["POLICY_MANAGEMENT","POLICY_MANAGEMENT_UPDATE"],expression:"['POLICY_MANAGEMENT', 'POLICY_MANAGEMENT_UPDATE']",arg:"or"}],attrs:{"delete-icon":!0},on:{actionClicked:function(e){return t.removeCondition()}}},[e("b-row",[e("b-col",{attrs:{md:"4",lg:"3"}},[e("b-input-group-form-select",{attrs:{id:"input-subject",required:"true",options:t.subjects},on:{change:t.subjectChanged},model:{value:t.subject,callback:function(e){t.subject=e},expression:"subject"}})],1),"EXPRESSION"!==t.subject?e("b-col",{attrs:{md:"3",lg:"2"}},[e("b-input-group-form-select",{attrs:{id:"input-operator",required:"true",options:t.operators},model:{value:t.operator,callback:function(e){t.operator=e},expression:"operator"}})],1):t._e(),"EXPRESSION"!==t.subject?e("b-col",{attrs:{md:"5",lg:"5"}},["COORDINATES"!==t.subject&&"VERSION_DISTANCE"!==t.subject&&t.isSubjectSelectable?e("b-input-group-form-select",{attrs:{id:"input-value",required:"true",options:t.possibleValues},on:{change:t.saveCondition},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):"COORDINATES"===t.subject||"VERSION_DISTANCE"===t.subject||t.isSubjectSelectable?"COORDINATES"===t.subject?e("b-input-group",[e("b-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value-coordinates-group",placeholder:t.$t("message.group"),type:"text","debounce-events":"keyup"},model:{value:t.coordinatesGroup,callback:function(e){t.coordinatesGroup=e},expression:"coordinatesGroup"}}),e("b-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value-coordinates-name",placeholder:t.$t("message.name"),type:"text","debounce-events":"keyup"},model:{value:t.coordinatesName,callback:function(e){t.coordinatesName=e},expression:"coordinatesName"}}),e("b-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value-coordinates-version",placeholder:t.$t("message.version"),type:"text","debounce-events":"keyup"},model:{value:t.coordinatesVersion,callback:function(e){t.coordinatesVersion=e},expression:"coordinatesVersion"}}),e("b-tooltip",{attrs:{target:"input-value-coordinates-version",triggers:"hover focus"}},[t._v(t._s(t.$t("message.coordinates_version_tooltip")))])],1):"VERSION_DISTANCE"===t.subject?e("b-input-group",[e("b-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value-distance-epoch",placeholder:t.$t("message.version_distance_epoch"),type:"number",min:"0",oninput:"validity.valid||(value='');","debounce-events":"keyup"},model:{value:t.versionDistance.epoch,callback:function(e){t.$set(t.versionDistance,"epoch",e)},expression:"versionDistance.epoch"}}),e("b-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value-distance-major",placeholder:t.$t("message.version_distance_major"),type:"number",min:"0",oninput:"validity.valid||(value='');","debounce-events":"keyup"},model:{value:t.versionDistance.major,callback:function(e){t.$set(t.versionDistance,"major",e)},expression:"versionDistance.major"}}),e("b-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value-distance-minor",placeholder:t.$t("message.version_distance_minor"),type:"number",min:"0",oninput:"validity.valid||(value='');","debounce-events":"keyup"},model:{value:t.versionDistance.minor,callback:function(e){t.$set(t.versionDistance,"minor",e)},expression:"versionDistance.minor"}}),e("b-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value-distance-patch",placeholder:t.$t("message.version_distance_patch"),type:"number",min:"0",oninput:"validity.valid||(value='');","debounce-events":"keyup"},model:{value:t.versionDistance.patch,callback:function(e){t.$set(t.versionDistance,"patch",e)},expression:"versionDistance.patch"}}),e("b-tooltip",{attrs:{target:"input-value-distance-epoch",triggers:"hover focus"}},[t._v(t._s(t.$t("message.version_distance_tooltip")))]),e("b-tooltip",{attrs:{target:"input-value-distance-major",triggers:"hover focus"}},[t._v(t._s(t.$t("message.version_distance_tooltip")))]),e("b-tooltip",{attrs:{target:"input-value-distance-minor",triggers:"hover focus"}},[t._v(t._s(t.$t("message.version_distance_tooltip")))]),e("b-tooltip",{attrs:{target:"input-value-distance-patch",triggers:"hover focus"}},[t._v(t._s(t.$t("message.version_distance_tooltip")))])],1):t._e():e("b-input-group-form-input",{directives:[{name:"debounce",rawName:"v-debounce:750ms",value:t.saveCondition,expression:"saveCondition",arg:"750ms"}],attrs:{id:"input-value",required:"true",type:"text",lazy:"true",tooltip:t.valueInputTooltip(),"debounce-events":"keyup"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1):t._e(),"EXPRESSION"===t.subject?e("b-col",{attrs:{lg:"6"}},["EXPRESSION"===t.subject?e("MonacoEditor",{directives:[{name:"debounce",rawName:"v-debounce:1s",value:t.saveCondition,expression:"saveCondition",arg:"1s"}],attrs:{id:"input-value",markers:this.editorMarkers,"debounce-events":"keyup"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}):t._e()],1):t._e(),"EXPRESSION"===t.subject?e("b-col",{attrs:{lg:"2"}},["EXPRESSION"===t.subject?e("b-form-select",{attrs:{id:"input-value-violationtype",options:t.violationTypes},on:{change:t.saveCondition},model:{value:t.violationType,callback:function(e){t.violationType=e},expression:"violationType"}}):t._e()],1):t._e(),e("b-col",{attrs:{md:"0",lg:"2"}})],1)],1)},T=[],$=function(){var t=this,e=t._self._c;return e("div",{ref:"monaco-editor",staticStyle:{border:"1px solid #52525e","border-radius":"0.25rem",height:"100px"}})},L=[];function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){P(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function w(t,e){if(null==t)return{};var n,o,i={},a=Object.keys(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||(i[n]=t[n]);return i}function R(t,e){if(null==t)return{};var n,o,i=w(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function x(t,e){return j(t)||G(t,e)||k(t,e)||U()}function j(t){if(Array.isArray(t))return t}function G(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0)if(n.push(r.value),e&&n.length===e)break}catch(l){i=!0,a=l}finally{try{o||null==s["return"]||s["return"]()}finally{if(i)throw a}}return n}}function k(t,e){if(t){if("string"===typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function U(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){Y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function z(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduceRight((function(t,e){return e(t)}),t)}}function F(t){return function e(){for(var n=this,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return i.length>=t.length?t.apply(this,i):function(){for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return e.apply(n,[].concat(i,o))}}}function H(t){return{}.toString.call(t).includes("Object")}function q(t){return!Object.keys(t).length}function W(t){return"function"===typeof t}function X(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function J(t,e){return H(e)||nt("changeType"),Object.keys(e).some((function(e){return!X(t,e)}))&&nt("changeField"),e}function Q(t){W(t)||nt("selectorType")}function K(t){W(t)||H(t)||nt("handlerType"),H(t)&&Object.values(t).some((function(t){return!W(t)}))&&nt("handlersType")}function Z(t){t||nt("initialIsRequired"),H(t)||nt("initialType"),q(t)&&nt("initialContent")}function tt(t,e){throw new Error(t[e]||t["default"])}var et={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},nt=F(tt)(et),ot={changes:J,selector:Q,handler:K,initial:Z};function it(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ot.initial(t),ot.handler(e);var n={current:t},o=F(st)(n,e),i=F(rt)(n),a=F(ot.changes)(t),r=F(at)(n);function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(t){return t};return ot.selector(t),t(n.current)}function l(t){z(o,i,a,r)(t)}return[s,l]}function at(t,e){return W(e)?e(t.current):e}function rt(t,e){return t.current=B(B({},t.current),e),e}function st(t,e,n){return W(e)?e(t.current):Object.keys(n).forEach((function(n){var o;return null===(o=e[n])||void 0===o?void 0:o.call(e,t.current[n])})),n}var lt={create:it},ct=lt,ut={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}},dt=ut;function pt(t){return function e(){for(var n=this,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return i.length>=t.length?t.apply(this,i):function(){for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return e.apply(n,[].concat(i,o))}}}var ft=pt;function ht(t){return{}.toString.call(t).includes("Object")}var mt=ht;function bt(t){return t||Et("configIsRequired"),mt(t)||Et("configType"),t.urls?(gt(),{paths:{vs:t.urls.monacoBase}}):t}function gt(){console.warn(yt.deprecation)}function vt(t,e){throw new Error(t[e]||t["default"])}var yt={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},Et=ft(vt)(yt),_t={config:bt},St=_t,It=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduceRight((function(t,e){return e(t)}),t)}},Nt=It;function At(t,e){return Object.keys(e).forEach((function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],At(t[n],e[n]))})),M(M({},t),e)}var Ot=At,Tt={type:"cancelation",msg:"operation is manually canceled"};function $t(t){var e=!1,n=new Promise((function(n,o){t.then((function(t){return e?o(Tt):n(t)})),t["catch"](o)}));return n.cancel=function(){return e=!0},n}var Lt=$t,Pt=ct.create({config:dt,isInitialized:!1,resolve:null,reject:null,monaco:null}),Ct=x(Pt,2),Mt=Ct[0],wt=Ct[1];function Rt(t){var e=St.config(t),n=e.monaco,o=R(e,["monaco"]);wt((function(t){return{config:Ot(t.config,o),monaco:n}}))}function xt(){var t=Mt((function(t){var e=t.monaco,n=t.isInitialized,o=t.resolve;return{monaco:e,isInitialized:n,resolve:o}}));if(!t.isInitialized){if(wt({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Lt(Vt);if(window.monaco&&window.monaco.editor)return Ut(window.monaco),t.resolve(window.monaco),Lt(Vt);Nt(jt,kt)(Dt)}return Lt(Vt)}function jt(t){return document.body.appendChild(t)}function Gt(t){var e=document.createElement("script");return t&&(e.src=t),e}function kt(t){var e=Mt((function(t){var e=t.config,n=t.reject;return{config:e,reject:n}})),n=Gt("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function Dt(){var t=Mt((function(t){var e=t.config,n=t.resolve,o=t.reject;return{config:e,resolve:n,reject:o}})),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],(function(e){Ut(e),t.resolve(e)}),(function(e){t.reject(e)}))}function Ut(t){Mt().monaco||wt({monaco:t})}function Yt(){return Mt((function(t){var e=t.monaco;return e}))}var Vt=new Promise((function(t,e){return wt({resolve:t,reject:e})})),Bt={config:Rt,init:xt,__getMonacoInstance:Yt},zt=Bt,Ft={name:"MonacoEditor",props:{value:String,readOnly:Boolean,markers:[]},data:function(){return{monaco:null,editor:null,editorModel:null}},mounted:function(){var t=this;zt.init().then((function(e){t.monaco=e,t.editor=e.editor.create(t.$refs["monaco-editor"],{automaticLayout:!0,bracketPairColorization:!0,cursorBlinking:"phase",language:"python",lineDecorationsWidth:0,matchBrackets:!0,minimap:{enabled:!1},lineNumbersMinChars:3,overviewRulerLanes:0,scrollBeyondLastLine:!1,theme:"vs-dark",wordWrap:"on",wrappingStrategy:"advanced",readOnly:t.readOnly}),t.editorModel=t.editor.getModel(),t.editorModel.onDidChangeContent(t.handleContentChange),t.editorModel.setValue(t.value?t.value:"")}))},beforeDestroy:function(){this.editor&&(this.editorModel.dispose(),this.editor.dispose(),this.editor=null,this.editorModel=null)},methods:{handleContentChange:function(t){this.monaco.editor.removeAllMarkers("foo"),this.$emit("change",this.editor.getValue(),t),this.$emit("input",this.editor.getValue())}},watch:{value:function(){this.editor&&this.value!==this.editor.getValue()&&this.editorModel.setValue(this.value)},markers:function(){this.markers||this.monaco.editor.removeAllMarkers("foo"),this.monaco.editor.setModelMarkers(this.editorModel,"foo",this.markers)}}},Ht=Ft,qt=Object(b["a"])(Ht,$,L,!1,null,null,null),Wt=qt.exports,Xt={props:{policy:Object,condition:Object},components:{ActionableListGroupItem:_["a"],BInputGroupFormSelect:A["a"],BInputGroupFormInput:S["a"],MonacoEditor:Wt},created:function(){this.condition&&(this.uuid=this.condition.uuid,this.subject=this.condition.subject,this.subjectChanged(),this.operator=this.condition.operator,this.value=this.condition.value,this.violationType=this.condition.violationType)},data:function(){return{uuid:null,subject:null,operator:null,value:null,violationType:null,coordinatesGroup:null,coordinatesName:null,coordinatesVersion:null,versionDistance:{epoch:null,major:null,minor:null,patch:null},subjects:[{value:"AGE",text:this.$t("message.age")},{value:"SEVERITY",text:this.$t("message.severity")},{value:"COORDINATES",text:this.$t("message.coordinates")},{value:"LICENSE",text:this.$t("message.license")},{value:"LICENSE_GROUP",text:this.$t("message.license_group")},{value:"PACKAGE_URL",text:this.$t("message.package_url")},{value:"CPE",text:this.$t("message.cpe_full")},{value:"SWID_TAGID",text:this.$t("message.swid_tagid")},{value:"VERSION",text:this.$t("message.version")},{value:"COMPONENT_HASH",text:this.$t("message.component_hash")},{value:"CWE",text:this.$t("message.cwe_full")},{value:"EPSS",text:this.$t("message.epss_score")},{value:"VULNERABILITY_ID",text:this.$t("message.vulnerability_vuln_id")},{value:"VERSION_DISTANCE",text:this.$t("message.version_distance")},{value:"EXPRESSION",text:"Expression"}],objectOperators:[{value:"IS",text:this.$t("operator.is")},{value:"IS_NOT",text:this.$t("operator.is_not")}],regexOperators:[{value:"MATCHES",text:this.$t("operator.matches")},{value:"NO_MATCH",text:this.$t("operator.no_match")}],numericOperators:[{value:"NUMERIC_GREATER_THAN",text:">"},{value:"NUMERIC_LESS_THAN",text:"<"},{value:"NUMERIC_EQUAL",text:"="},{value:"NUMERIC_NOT_EQUAL",text:"≠"},{value:"NUMERIC_GREATER_THAN_OR_EQUAL",text:"≥"},{value:"NUMERIC_LESSER_THAN_OR_EQUAL",text:"≤"}],hashAlgorithms:[{value:"MD5",text:this.$t("hashes.md5")},{value:"SHA-1",text:this.$t("hashes.sha_1")},{value:"SHA-256",text:this.$t("hashes.sha_256")},{value:"SHA-384",text:this.$t("hashes.sha_384")},{value:"SHA-512",text:this.$t("hashes.sha_512")},{value:"SHA3-256",text:this.$t("hashes.sha3_256")},{value:"SHA3-384",text:this.$t("hashes.sha3_384")},{value:"SHA3-512",text:this.$t("hashes.sha3_512")},{value:"BLAKE2b-256",text:this.$t("hashes.blake_256")},{value:"BLAKE2b-384",text:this.$t("hashes.blake_384")},{value:"BLAKE2b-512",text:this.$t("hashes.blake_512")},{value:"BLAKE3",text:this.$t("hashes.blake3")}],listOperators:[{value:"CONTAINS_ANY",text:this.$t("operator.contains_any")},{value:"CONTAINS_ALL",text:this.$t("operator.contains_all")}],violationTypes:[{value:"LICENSE",text:"License"},{value:"OPERATIONAL",text:"Operational"},{value:"SECURITY",text:"Security"}],operators:[],possibleValues:[],editorMarkers:[]}},computed:{isSubjectSelectable:function(){switch(this.subject){case"AGE":return!1;case"ANALYZER":return!0;case"BOM":return!0;case"SEVERITY":return!0;case"COORDINATES":return!1;case"LICENSE":return!0;case"LICENSE_GROUP":return!0;case"PACKAGE_URL":return!1;case"CPE":return!1;case"SWID_TAGID":return!1;case"VERSION":return!1;case"COMPONENT_HASH":return!1;case"CWE":return!1;case"VULNERABILITY_ID":return!1;case"VERSION_DISTANCE":return!1;case"EPSS":return!1;case"EXPRESSION":return!1;default:return!1}}},beforeMount:function(){if("COORDINATES"===this.subject){var t=JSON.parse(this.value);t&&(this.coordinatesGroup=t.group,this.coordinatesName=t.name,this.coordinatesVersion=t.version)}else if("VERSION_DISTANCE"===this.subject){var e=JSON.parse(this.value);e&&(this.versionDistance=e)}},methods:{subjectChanged:function(){switch(this.subject){case"AGE":this.operators=this.numericOperators;break;case"ANALYZER":this.operators=this.objectOperators;break;case"BOM":this.operators=this.objectOperators;break;case"SEVERITY":this.operators=this.objectOperators,this.populateSeverity();break;case"COORDINATES":this.operators=this.regexOperators;break;case"LICENSE":this.operators=this.objectOperators,this.retrieveLicenses();break;case"LICENSE_GROUP":this.operators=this.objectOperators,this.retrieveLicenseGroups();break;case"PACKAGE_URL":this.operators=this.regexOperators;break;case"CPE":this.operators=this.regexOperators;break;case"SWID_TAGID":this.operators=this.regexOperators;break;case"VERSION":this.operators=this.numericOperators;break;case"COMPONENT_HASH":this.operators=this.hashAlgorithms;break;case"CWE":this.operators=this.listOperators;break;case"VULNERABILITY_ID":this.operators=this.objectOperators;break;case"VERSION_DISTANCE":this.operators=this.numericOperators;break;case"EPSS":this.operators=this.numericOperators;break;case"EXPRESSION":this.operators=this.regexOperators;break;default:this.operators=[]}this.saveCondition()},createDynamicValue:function(){if("COORDINATES"===this.subject)return JSON.stringify({group:l["a"].trimToNull(this.coordinatesGroup),name:l["a"].trimToNull(this.coordinatesName),version:l["a"].trimToNull(this.coordinatesVersion)});if("COMPONENT_HASH"===this.subject)return JSON.stringify({algorithm:l["a"].trimToNull(this.operator),value:l["a"].trimToNull(this.value)});if("VERSION_DISTANCE"===this.subject){var t={epoch:this.parseIntNull(l["a"].trimToNull(this.versionDistance.epoch)),major:this.parseIntNull(l["a"].trimToNull(this.versionDistance.major)),minor:this.parseIntNull(l["a"].trimToNull(this.versionDistance.minor)),patch:this.parseIntNull(l["a"].trimToNull(this.versionDistance.patch))};return t.epoch<0&&(t.epoch=0),t.major<0&&(t.major=null,t.minor=null,t.patch=null),t.minor<0&&(t.minor=null,t.patch=null),t.patch<0&&(t.patch=null),this.versionDistance=t,JSON.stringify(t)}return this.value},saveCondition:function(){var t=this,e=this.createDynamicValue();if(this.subject&&("EXPRESSION"!==this.subject||this.violationType&&e)&&("EXPRESSION"===this.subject||this.operator&&e))if(this.uuid){var n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY,"/condition");this.axios.post(n,{uuid:this.uuid,subject:this.subject,operator:"COMPONENT_HASH"===this.subject?"IS":this.operator,violationType:"EXPRESSION"===this.subject?this.violationType:null,value:e}).then((function(e){t.uuid=e.data.uuid,t.subject=e.data.subject,t.operator=e.data.operator,t.value=e.data.value,t.violationType=e.data.violationType,t.$toastr.s(t.$t("message.updated"))})).catch((function(e){"EXPRESSION"===t.subject&&e.response&&e.response.data&&e.response.data.celErrors?t.editorMarkers=e.response.data.celErrors.map((function(t){return{startLineNumber:t.line,startColumn:t.column,endLineNumber:t.line,endColumn:t.column+3,message:t.message,severity:8}})):t.$toastr.w(t.$t("condition.unsuccessful_action"))}))}else{var o="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY,"/").concat(this.policy.uuid,"/condition");this.axios.put(o,{subject:this.subject,operator:"COMPONENT_HASH"===this.subject?"IS":this.operator,value:e,violationType:"EXPRESSION"===this.subject?this.violationType:null}).then((function(e){t.uuid=e.data.uuid,t.subject=e.data.subject,t.operator=e.data.operator,t.value=e.data.value,t.violationType=e.data.violationType,t.$toastr.s(t.$t("message.updated"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))}},removeCondition:function(){var t=this;if(this.uuid){var e="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY,"/condition/").concat(this.uuid);this.axios.delete(e).then((function(e){t.uuid=e.data.uuid,t.subject=e.data.subject,t.operator=e.data.operator,t.value=e.data.value,t.violationType=e.data.violationType,t.$toastr.s(t.$t("message.condition_deleted")),t.$emit("conditionRemoved")})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))}else this.$emit("conditionRemoved")},retrieveLicenseGroups:function(){var t=this;this.axios.get("".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_GROUP,"?limit=9999")).then((function(e){for(var n=[],o=0;o<e.data.length;o++){var i=e.data[o];n.push({value:i.uuid,text:i.name})}t.possibleValues=n})).catch((function(e){304===e.response.status||t.$toastr.w(t.$t("condition.unsuccessful_action"))}))},retrieveLicenses:function(){var t=this;this.axios.get("".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_CONCISE,"?limit=9999")).then((function(e){var n=[];n.push({value:"unresolved",text:"unresolved"});for(var o=0;o<e.data.length;o++){var i=e.data[o];n.push({value:i.uuid,text:i.name})}t.possibleValues=n})).catch((function(e){304===e.response.status||t.$toastr.w(t.$t("condition.unsuccessful_action"))}))},populateSeverity:function(){this.possibleValues=[{value:"CRITICAL",text:this.$t("severity.critical")},{value:"HIGH",text:this.$t("severity.high")},{value:"MEDIUM",text:this.$t("severity.medium")},{value:"LOW",text:this.$t("severity.low")},{value:"INFO",text:this.$t("severity.info")},{value:"UNASSIGNED",text:this.$t("severity.unassigned")}]},valueInputTooltip:function(){switch(this.subject){case"AGE":return this.$t("message.age_tooltip");default:return""}},parseIntNull:function(t){return null==t?null:parseInt(t)}}},Jt=Xt,Qt=Object(b["a"])(Jt,O,T,!1,null,null,null),Kt=Qt.exports,Zt=n("2f0e"),te=n("f307"),ee=function(){var t=this,e=t._self._c;return e("b-modal",{directives:[{name:"permission",rawName:"v-permission",value:"VIEW_PORTFOLIO",expression:"'VIEW_PORTFOLIO'"}],attrs:{id:"selectTagModal",size:"lg","hide-header-close":"","no-stacking":"",title:t.$t("message.select_tag")},scopedSlots:t._u([{key:"modal-footer",fn:function(n){var o=n.cancel;return[e("b-button",{attrs:{size:"md",variant:"secondary"},on:{click:function(t){return o()}}},[t._v(t._s(t.$t("message.cancel")))]),e("b-button",{attrs:{size:"md",variant:"primary"},on:{click:function(e){t.$emit("selection",t.$refs.table.getSelections())}}},[t._v(t._s(t.$t("message.select")))])]}}])},[e("bootstrap-table",{ref:"table",attrs:{columns:t.columns,data:t.data,options:t.options}})],1)},ne=[],oe={props:{policy:Object},mixins:[a["a"]],methods:{apiUrl:function(){var t="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_TAG,"/policy/").concat(this.policy.uuid);return t},refreshTable:function(){this.$refs.table.refresh({url:this.apiUrl(),pageNumber:1,silent:!0})}},watch:{showInactiveTags:function(){this.refreshTable()}},data:function(){return{showInactiveTags:!1,labelIcon:{dataOn:"✓",dataOff:"✕"},columns:[{field:"state",checkbox:!0,align:"center"},{title:this.$t("message.tag_name"),field:"name",sortable:!0,formatter:function(t){return u.a.inHTMLData(l["a"].valueWithDefault(t,""))}}],data:[],options:{search:!0,showColumns:!0,showRefresh:!0,pagination:!0,silentSort:!1,sidePagination:"server",queryParamsType:"pageSize",pageList:"[10, 25, 50, 100]",pageSize:10,icons:{refresh:"fa-refresh"},toolbar:"#tagsToolbar",responseHandler:function(t,e){return t.total=e.getResponseHeader("X-Total-Count"),t},url:this.apiUrl()}}}},ie=oe,ae=Object(b["a"])(ie,ee,ne,!1,null,null,null),re=ae.exports,se=n("3acd");function le(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ce(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function ce(t,e){if(t){if("string"==typeof t)return ue(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(t,e):void 0}}function ue(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}var de={mixins:[a["a"],N["a"],y["a"]],components:{BInputGroupFormSwitch:se["a"],CreatePolicyModal:v},mounted:function(){var t=this;I["a"].$on("policyManagement:policies:rowUpdate",(function(e,n){t.$refs.table.updateRow({index:e,row:n}),t.$refs.table.expandRow(e)})),I["a"].$on("policyManagement:policies:rowDeleted",(function(e,n){t.refreshTable()}))},beforeDestroy:function(){I["a"].$off("policyManagement:policies:rowUpdate"),I["a"].$off("policyManagement:policies:rowDeleted")},methods:{tableLoaded:function(t){t&&Object.prototype.hasOwnProperty.call(t,"total")?this.$emit("total",t.total):this.$emit("total","?")},refreshTable:function(){this.$refs.table.refresh({silent:!0})}},data:function(){var t=this;return{columns:[{title:this.$t("message.name"),field:"name",sortable:!0,formatter:function(t,e,n){return l["a"].formatNotificationLabel(e.violationState)+" ".concat(u.a.inHTMLData(t))}}],data:[],options:{showHeader:!1,search:!0,showColumns:!1,showRefresh:!0,pagination:!0,silentSort:!1,sidePagination:"server",queryParamsType:"pageSize",pageList:"[10, 25, 50, 100]",pageSize:localStorage&&null!==localStorage.getItem("PolicyListPageSize")?Number(localStorage.getItem("PolicyListPageSize")):10,searchText:this.$route.query.searchText?this.$route.query.searchText:"",icons:{refresh:"fa-refresh"},detailView:!0,detailViewIcon:!1,detailViewByClick:!0,detailFormatter:function(e,n){return t.vueFormatter({i18n:E["a"],template:'\n                <div>\n                <b-row class="expanded-row">\n                  <b-col sm="6">\n                    <b-input-group-form-input id="identifier" :label="this.$t(\'message.name\')" input-group-size="mb-3"\n                        required="true" type="text" v-model="name" lazy="true" autofocus="true"\n                        v-debounce:750ms="updatePolicy" :debounce-events="\'keyup\'" />\n                  </b-col>\n                  <b-col sm="3">\n                    <b-input-group-form-select id="input-repository-type" required="true"\n                               v-model="operator" :options="operators"\n                               :label="$t(\'message.operator\')" />\n                  </b-col>\n                  <b-col sm="3">\n                    <b-input-group-form-select id="input-repository-type" required="true"\n                               v-model="violationState" :options="violationStates"\n                               :label="$t(\'message.violation_state\')" />\n                  </b-col>\n                </b-row>\n                <b-row class="expanded-row">\n                  <b-col sm="12">\n                    <b-form-group :label="this.$t(\'message.conditions\')">\n                      <div class="list-group">\n                        <span v-for="(condition, conditionIndex) in conditions">\n                          <policy-condition :policy="policy" :condition="condition" v-on:conditionRemoved="removeCondition(condition, conditionIndex, index)" />\n                        </span>\n                        <actionable-list-group-item v-permission:or="[PERMISSIONS.POLICY_MANAGEMENT, PERMISSIONS.POLICY_MANAGEMENT_UPDATE]" :add-icon="true" v-on:actionClicked="addCondition" />\n                      </div>\n                    </b-form-group>\n                    <b-form-group v-if="limitToVisible === true" id="projectLimitsList" :label="this.$t(\'admin.limit_to_projects\')">\n                      <div class="list-group">\n                        <span v-for="project in projects">\n                          <actionable-list-group-item :value="formatLabel(project.name, project.version)" :delete-icon="true" v-on:actionClicked="deleteProjectLimiter(project.uuid)"/>\n                        </span>\n                        <actionable-list-group-item v-permission:or="[PERMISSIONS.POLICY_MANAGEMENT, PERMISSIONS.POLICY_MANAGEMENT_UPDATE]" :add-icon="true" v-on:actionClicked="$root.$emit(\'bv::show::modal\', \'selectProjectModal\')"/>\n                      </div>\n                    </b-form-group>\n                    <div v-if="limitToVisible === true" style="margin-bottom: 1.5rem">\n                      <b-row>\n                        <b-col cols="auto">\n                          <b-input-group-form-switch\n                            id="isNotifyChildrenEnabled"\n                            :label="$t(\'admin.include_children\')"\n                            v-model="includeChildren"\n                          />\n                        </b-col>\n                        <b-col>\n                          <b-input-group-form-switch\n                            id="isOnlyLatestProjectVersion"\n                            :label="$t(\'message.policy_is_only_for_latest_project_version\')"\n                            v-model="onlyLatestProjectVersion"\n                          />\n                        </b-col>\n                      </b-row>\n                    </div>\n                    <b-form-group v-if="limitToVisible === true" id="tagLimitsList" :label="this.$t(\'admin.limit_to_tags\')">\n                      <div class="list-group">\n                        <span v-for="tag in tags">\n                          <actionable-list-group-item :value="formatLabel(tag.name, tag.id)" :delete-icon="true" v-on:actionClicked="deleteTagLimiter(tag.name)"/>\n                        </span>\n                        <actionable-list-group-item v-permission:or="[PERMISSIONS.POLICY_MANAGEMENT, PERMISSIONS.POLICY_MANAGEMENT_UPDATE]" :add-icon="true" v-on:actionClicked="$root.$emit(\'bv::show::modal\', \'selectTagModal\')"/>\n                      </div>\n                    </b-form-group>\n                    <div style="text-align:right">\n                      <b-toggleable-display-button variant="outline-primary" :label="$t(\'admin.limit_to\')"\n                          v-permission="PERMISSIONS.VIEW_PORTFOLIO" v-on:toggle="limitToVisible = !limitToVisible" />\n                       <b-button v-permission:or="[\'POLICY_MANAGEMENT\', \'POLICY_MANAGEMENT_DELETE\']" variant="outline-danger" @click="deletePolicy">{{ $t(\'message.delete_policy\') }}</b-button>\n                    </div>\n                  </b-col>\n                </b-row>\n                <select-project-modal v-on:selection="updateProjectSelection"/>\n                <select-tag-modal :policy="policy" v-on:selection="updateTagSelection"/>\n              </div>\n              ',mixins:[a["a"]],components:{ActionableListGroupItem:_["a"],BInputGroupFormInput:S["a"],BInputGroupFormSelect:A["a"],BToggleableDisplayButton:Zt["a"],SelectProjectModal:te["a"],SelectTagModal:re,PolicyCondition:Kt,BInputGroupFormSwitch:se["a"]},data:function(){return{policy:n,name:n.name,operator:n.operator,violationState:n.violationState,conditions:n.policyConditions,operators:[{value:"ANY",text:"Any"},{value:"ALL",text:"All"}],violationStates:[{value:"INFO",text:this.$t("violation.info")},{value:"WARN",text:this.$t("violation.warn")},{value:"FAIL",text:this.$t("violation.fail")}],projects:n.projects||[],limitToVisible:!1,tags:n.tags,includeChildren:n.includeChildren,onlyLatestProjectVersion:n.onlyLatestProjectVersion}},methods:{formatLabel:function(t,e){return t&&e?t+" "+e:t},addCondition:function(){this.conditions||(this.conditions=[]),this.conditions.push({})},removeCondition:function(t,e,n){this.conditions=[],this.refreshPolicy()},refreshPolicy:function(){var t=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY,"/").concat(this.policy.uuid);this.axios.get(n).then((function(n){t.policy=n.data,I["a"].$emit("policyManagement:policies:rowUpdate",e,t.policy)}))},updatePolicy:function(){var t=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY),o=null===this.policy.uuid||this.name!==this.policy.name;this.axios.post(n,{uuid:this.policy.uuid,name:this.name,operator:this.operator,violationState:this.violationState,includeChildren:this.includeChildren,onlyLatestProjectVersion:this.onlyLatestProjectVersion}).then((function(n){o&&(t.policy=n.data,I["a"].$emit("policyManagement:policies:rowUpdate",e,t.policy)),t.$toastr.s(t.$t("message.updated"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))},deletePolicy:function(){var t=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY,"/").concat(this.policy.uuid);this.axios.delete(n).then((function(n){I["a"].$emit("policyManagement:policies:rowDeleted",e),t.$toastr.s(t.$t("message.policy_deleted"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))},syncVariables:function(t){this.policy=t,this.name=t.name,this.operator=t.operator,this.violationState=t.violationState,this.conditions=t.policyConditions,this.includeChildren=t.includeChildren,this.onlyLatestProjectVersion=t.onlyLatestProjectVersion},deleteProjectLimiter:function(t){var e=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY,"/").concat(this.policy.uuid,"/project/").concat(t);this.axios.delete(n).then((function(n){for(var o=[],i=0;i<e.projects.length;i++)e.projects[i].uuid!==t&&o.push(e.projects[i]);e.projects=o,e.$toastr.s(e.$t("message.updated"))})).catch((function(t){e.$toastr.w(e.$t("condition.unsuccessful_action"))}))},deleteTagLimiter:function(t){var e=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_TAG,"/").concat(encodeURIComponent(t),"/policy");this.axios.delete(n,{data:[this.policy.uuid]}).then((function(){for(var n=[],o=0;o<e.tags.length;o++)e.tags[o].name!==t&&n.push(e.tags[o]);e.tags=n,e.$toastr.s(e.$t("message.updated"))}))},updateProjectSelection:function(t){var e=this;this.$root.$emit("bv::hide::modal","selectProjectModal");for(var n=function(){var n=t[o],i="".concat(e.$api.BASE_URL,"/").concat(e.$api.URL_POLICY,"/").concat(e.policy.uuid,"/project/").concat(n.uuid);e.axios.post(i).then((function(t){e.projects.push(n),e.$toastr.s(e.$t("message.updated"))})).catch((function(t){304===t.response.status||e.$toastr.w(e.$t("condition.unsuccessful_action"))}))},o=0;o<t.length;o++)n()},updateTagSelection:function(t){var e=this;this.$root.$emit("bv::hide::modal","selectTagModal");for(var n=[],o=function(){var o=t[i],a="".concat(e.$api.BASE_URL,"/").concat(e.$api.URL_TAG,"/").concat(encodeURIComponent(o.name),"/policy");n.push(e.axios.post(a,[e.policy.uuid]).then((function(){return Promise.resolve(o.name)})))},i=0;i<t.length;i++)o();Promise.all(n).then((function(t){var n,o=le(t);try{var i=function(){var t=n.value;e.tags.some((function(e){return e.name===t}))||e.tags.push({name:t})};for(o.s();!(n=o.n()).done;)i()}catch(a){o.e(a)}finally{o.f()}e.$toastr.s(e.$t("message.updated"))}))}},watch:{operator:function(){this.updatePolicy()},violationState:function(){this.updatePolicy()},includeChildren:function(){this.updatePolicy()},onlyLatestProjectVersion:function(){this.updatePolicy()}}})},onExpandRow:this.vueFormatterInit,toolbar:"#policiesToolbar",responseHandler:function(t,e){return t.total=e.getResponseHeader("X-Total-Count"),t},url:"".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_POLICY),onPageChange:function(t,e){localStorage&&localStorage.setItem("PolicyListPageSize",e.toString())},onSearch:function(e){t.setSearchTextQuery(e)}}}}},pe=de,fe=Object(b["a"])(pe,r,s,!1,null,null,null),he=fe.exports,me=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"permission",rawName:"v-permission:or",value:["POLICY_MANAGEMENT","POLICY_MANAGEMENT_CREATE","POLICY_MANAGEMENT_READ","POLICY_MANAGEMENT_UPDATE","POLICY_MANAGEMENT_DELETE"],expression:"[\n    'POLICY_MANAGEMENT',\n    'POLICY_MANAGEMENT_CREATE',\n    'POLICY_MANAGEMENT_READ',\n    'POLICY_MANAGEMENT_UPDATE',\n    'POLICY_MANAGEMENT_DELETE',\n  ]",arg:"or"}],staticClass:"animated fadeIn"},[e("div",{staticClass:"bs-table-custom-toolbar",attrs:{id:"licenseGroupsToolbar"}},[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.createLicenseGroupModal",modifiers:{createLicenseGroupModal:!0}},{name:"permission",rawName:"v-permission:or",value:[t.PERMISSIONS.POLICY_MANAGEMENT,t.PERMISSIONS.POLICY_MANAGEMENT_CREATE],expression:"[\n        PERMISSIONS.POLICY_MANAGEMENT,\n        PERMISSIONS.POLICY_MANAGEMENT_CREATE,\n      ]",arg:"or"}],attrs:{size:"md",variant:"outline-primary"}},[e("span",{staticClass:"fa fa-plus"}),t._v("\n      "+t._s(t.$t("message.create_license_group"))+"\n    ")])],1),e("bootstrap-table",{ref:"table",attrs:{columns:t.columns,data:t.data,options:t.options},on:{"on-load-success":t.tableLoaded}}),e("create-license-group-modal",{on:{refreshTable:t.refreshTable}})],1)},be=[],ge=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"createLicenseGroupModal",size:"md","hide-header-close":"","no-stacking":"",title:t.$t("message.create_license_group")},on:{hide:function(e){return t.resetValues()}},scopedSlots:t._u([{key:"modal-footer",fn:function(n){var o=n.cancel;return[e("b-button",{attrs:{size:"md",variant:"secondary"},on:{click:function(t){return o()}}},[t._v(t._s(t.$t("message.close")))]),e("b-button",{attrs:{size:"md",variant:"primary"},on:{click:function(e){return t.createLicenseGroup()}}},[t._v(t._s(t.$t("message.create")))])]}}])},[e("b-validated-input-group-form-input",{attrs:{id:"identifier",label:this.$t("message.name"),"input-group-size":"mb-3",rules:"required"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)},ve=[],ye={name:"createLicenseGroupModal",mixins:[a["a"]],components:{BValidatedInputGroupFormInput:f["a"]},data:function(){return{name:null}},methods:{createLicenseGroup:function(){var t=this,e="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_GROUP);this.axios.put(e,{name:this.name}).then((function(e){t.$emit("refreshTable"),t.$root.$emit("bv::hide::modal","createLicenseGroupModal"),t.$toastr.s(t.$t("message.license_group_created"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))})),this.resetValues()},resetValues:function(){this.name=null}}},Ee=ye,_e=Object(b["a"])(Ee,ge,ve,!1,null,null,null),Se=_e.exports,Ie=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"selectLicenseModal",size:"lg","hide-header-close":"","no-stacking":"",title:t.$t("message.select_license")},scopedSlots:t._u([{key:"modal-footer",fn:function(n){var o=n.cancel;return[e("b-button",{attrs:{size:"md",variant:"secondary"},on:{click:function(t){return o()}}},[t._v(t._s(t.$t("message.cancel")))]),e("b-button",{attrs:{size:"md",variant:"primary"},on:{click:function(e){t.$emit("selection",t.$refs.table.getSelections())}}},[t._v(t._s(t.$t("message.select")))])]}}])},[e("bootstrap-table",{ref:"table",attrs:{columns:t.columns,data:t.data,options:t.options}})],1)},Ne=[],Ae={mixins:[a["a"]],data:function(){return{labelIcon:{dataOn:"✓",dataOff:"✕"},columns:[{field:"state",checkbox:!0,align:"center"},{title:this.$t("message.name"),field:"name",sortable:!0,formatter:function(t,e,n){return u.a.inHTMLData(l["a"].valueWithDefault(t,""))}},{title:this.$t("message.spdx_license_id"),field:"licenseId",sortable:!0,formatter:function(t,e,n){var o=u.a.uriInUnQuotedAttr("../licenses/"+encodeURIComponent(t));return'<a href="'.concat(o,'">').concat(u.a.inHTMLData(t),"</a>")}}],data:[],options:{search:!0,showColumns:!0,showRefresh:!0,pagination:!0,silentSort:!1,sidePagination:"client",queryParamsType:"pageSize",pageList:"[10, 25, 50, 100]",pageSize:10,icons:{refresh:"fa-refresh"},responseHandler:function(t,e){return t.total=e.getResponseHeader("X-Total-Count"),t},url:"".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_CONCISE)}}}},Oe=Ae,Te=Object(b["a"])(Oe,Ie,Ne,!1,null,null,null),$e=Te.exports,Le={mixins:[a["a"],N["a"]],components:{CreateLicenseGroupModal:Se},mounted:function(){var t=this;I["a"].$on("policyManagement:licenseGroups:rowUpdate",(function(e,n){t.$refs.table.updateRow({index:e,row:n}),t.$refs.table.expandRow(e)})),I["a"].$on("policyManagement:licenseGroups:rowDeleted",(function(e,n){t.refreshTable()}))},beforeDestroy:function(){I["a"].$off("policyManagement:licenseGroups:rowUpdate"),I["a"].$off("policyManagement:licenseGroups:rowDeleted")},methods:{tableLoaded:function(t){t&&Object.prototype.hasOwnProperty.call(t,"total")?this.$emit("total",t.total):this.$emit("total","?")},refreshTable:function(){this.$refs.table.refresh({silent:!0})}},data:function(){var t=this;return{columns:[{title:this.$t("message.name"),field:"name",sortable:!0,formatter:function(t,e,n){return u.a.inHTMLData(l["a"].valueWithDefault(t,""))}}],data:[],options:{showHeader:!1,search:!0,showColumns:!1,showRefresh:!0,pagination:!0,silentSort:!1,sidePagination:"server",queryParamsType:"pageSize",pageList:"[10, 25, 50, 100]",pageSize:localStorage&&null!==localStorage.getItem("LicenseGroupListPageSize")?Number(localStorage.getItem("LicenseGroupListPageSize")):10,icons:{refresh:"fa-refresh"},detailView:!0,detailViewIcon:!1,detailViewByClick:!0,detailFormatter:function(e,n){return t.vueFormatter({i18n:E["a"],template:'\n                <div>\n                <b-row class="expanded-row">\n                  <b-col sm="6">\n                    <b-input-group-form-input id="input-license-group-name" :label="$t(\'message.name\')" input-group-size="mb-3"\n                                              required="true" type="text" v-model="name" lazy="true" autofocus="true"\n                                              v-debounce:750ms="updateLicenseGroup" :debounce-events="\'keyup\'" />\n                  </b-col>\n                  <b-col sm="6">\n                  </b-col>\n                </b-row>\n                <b-row class="expanded-row">\n                  <b-col sm="12">\n                    <b-form-group :label="this.$t(\'message.licenses\')">\n                      <div class="list-group">\n                        <span v-for="license in licenses">\n                          <actionable-list-group-item :value="license.name" v-permission:or="[PERMISSIONS.POLICY_MANAGEMENT, PERMISSIONS.POLICY_MANAGEMENT_UPDATE]" :delete-icon="true" v-on:actionClicked="removeLicense(license)"/>\n                        </span>\n                        <actionable-list-group-item v-permission:or="[PERMISSIONS.POLICY_MANAGEMENT, PERMISSIONS.POLICY_MANAGEMENT_UPDATE]" :add-icon="true" v-on:actionClicked="$root.$emit(\'bv::show::modal\', \'selectLicenseModal\')"/>\n                      </div>\n                    </b-form-group>\n                    <div style="text-align:right">\n                       <b-button v-permission:or="[\'POLICY_MANAGEMENT\', \'POLICY_MANAGEMENT_DELETE\']" variant="outline-danger" @click="deleteLicenseGroup">{{ $t(\'message.delete_license_group\') }}</b-button>\n                    </div>\n                  </b-col>\n                </b-row>\n                  <select-license-modal v-on:selection="updateLicenseSelection" />\n                </div>\n              ',mixins:[a["a"]],components:{ActionableListGroupItem:_["a"],BInputGroupFormInput:S["a"],SelectLicenseModal:$e},data:function(){return{licenseGroup:n,name:n.name,licenses:n.licenses}},methods:{updateLicenseGroup:function(){var t=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_GROUP);this.axios.post(n,{uuid:this.licenseGroup.uuid,name:this.name}).then((function(n){t.licenseGroup=n.data,I["a"].$emit("policyManagement:licenseGroups:rowUpdate",e,t.licenseGroup),t.$toastr.s(t.$t("message.updated"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))},deleteLicenseGroup:function(){var t=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_GROUP,"/").concat(this.licenseGroup.uuid);this.axios.delete(n).then((function(n){I["a"].$emit("policyManagement:licenseGroups:rowDeleted",e),t.$toastr.s(t.$t("message.license_group_deleted"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))},removeLicense:function(t){var e=this,n="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_GROUP,"/").concat(this.licenseGroup.uuid,"/license/").concat(t.uuid);this.axios.delete(n).then((function(t){e.syncVariables(t.data),e.$toastr.s(e.$t("message.updated"))})).catch((function(t){e.$toastr.w(e.$t("condition.unsuccessful_action"))}))},updateLicenseSelection:function(t){var e=this;this.$root.$emit("bv::hide::modal","selectLicenseModal");for(var n=0;n<t.length;n++){var o=t[n],i="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_GROUP,"/").concat(this.licenseGroup.uuid,"/license/").concat(o.uuid);this.axios.post(i).then((function(t){e.syncVariables(t.data),e.$toastr.s(e.$t("message.updated"))})).catch((function(t){304===t.response.status||e.$toastr.w(e.$t("condition.unsuccessful_action"))}))}},syncVariables:function(t){this.licenseGroup=t,this.name=t.name,this.licenses=t.licenses}}})},onExpandRow:this.vueFormatterInit,toolbar:"#licenseGroupsToolbar",responseHandler:function(t,e){return t.total=e.getResponseHeader("X-Total-Count"),t},url:"".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_LICENSE_GROUP),onPageChange:function(t,e){localStorage&&localStorage.setItem("LicenseGroupListPageSize",e.toString())}}}}},Pe=Le,Ce=Object(b["a"])(Pe,me,be,!1,null,null,null),Me=Ce.exports,we=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"permission",rawName:"v-permission:or",value:["POLICY_MANAGEMENT","POLICY_MANAGEMENT_CREATE","POLICY_MANAGEMENT_READ","POLICY_MANAGEMENT_UPDATE","POLICY_MANAGEMENT_DELETE"],expression:"[\n    'POLICY_MANAGEMENT',\n    'POLICY_MANAGEMENT_CREATE',\n    'POLICY_MANAGEMENT_READ',\n    'POLICY_MANAGEMENT_UPDATE',\n    'POLICY_MANAGEMENT_DELETE',\n  ]",arg:"or"}],staticClass:"animated fadeIn"},["FAILED"===t.bundleSyncStatus?e("b-alert",{attrs:{variant:"danger",dismissible:"",show:""}},[e("strong",[t._v(t._s(t.$t("message.policy_last_bundle_sync_failed")))]),t._v(": "+t._s(this.bundleSyncWorkflowState.failureReason)+"\n  ")]):t._e(),e("div",{staticClass:"bs-table-custom-toolbar",attrs:{id:"vulnerabilityPolicyToolbar"}},[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.policyBundleInfoModal",modifiers:{policyBundleInfoModal:!0}}],attrs:{variant:"outline-primary",disabled:!t.bundleInfo}},[e("span",{staticClass:"fa fa-archive"}),t._v("\n      "+t._s(t.$t("message.policy_bundle_info"))+"\n    ")]),e("b-button",{directives:[{name:"permission",rawName:"v-permission:or",value:[t.PERMISSIONS.POLICY_MANAGEMENT,t.PERMISSIONS.POLICY_MANAGEMENT_UPDATE],expression:"[\n        PERMISSIONS.POLICY_MANAGEMENT,\n        PERMISSIONS.POLICY_MANAGEMENT_UPDATE,\n      ]",arg:"or"}],attrs:{variant:"outline-primary",disabled:"PENDING"===t.bundleSyncStatus},on:{click:t.sync}},["PENDING"===t.bundleSyncStatus?e("b-spinner",{attrs:{small:""}}):t._e(),"PENDING"!==t.bundleSyncStatus?e("span",{staticClass:"fa fa-refresh"}):t._e(),t._v("\n      "+t._s(t.$t("message.policy_bundle_sync"))+"\n    ")],1)],1),e("bootstrap-table",{ref:"table",attrs:{columns:t.columns,data:t.data,options:t.options},on:{"on-load-success":t.tableLoaded}}),e("policy-bundle-info-modal",{attrs:{bundleInfo:t.cloneDeep(t.bundleInfo)}})],1)},Re=[],xe=n("1157"),je=n.n(xe),Ge=n("6397"),ke=n.n(Ge),De=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"policyBundleInfoModal",size:"lg","hide-header-close":"","no-stacking":"",title:t.$t("message.policy_bundle_info")},scopedSlots:t._u([{key:"modal-footer",fn:function(n){var o=n.cancel;return[e("b-button",{attrs:{size:"md",variant:"secondary"},on:{click:function(t){return o()}}},[t._v(t._s(t.$t("message.close")))])]}}])},[e("b-tabs",{staticClass:"body-bg-color",staticStyle:{border:"0",padding:"0"}},[e("b-tab",{staticClass:"body-bg-color",staticStyle:{border:"0",padding:"0"},attrs:{active:""},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-edit"}),t._v(" "+t._s(t.$t("message.general")))]},proxy:!0}])},[e("b-card",[e("b-input-group-form-input",{attrs:{id:"bundle-url","input-group-size":"mb-3",type:"text",lazy:"true",feedback:"false",autofocus:"true",label:t.$t("message.policy_bundle_url"),disabled:"true"},model:{value:t.bundleInfo.url,callback:function(e){t.$set(t.bundleInfo,"url",e)},expression:"bundleInfo.url"}}),e("b-input-group-form-input",{attrs:{id:"bundle-hash","input-group-size":"mb-3",type:"text",lazy:"true",feedback:"false",autofocus:"false",label:t.$t("message.policy_bundle_hash"),disabled:"true"},model:{value:t.bundleInfo.hash,callback:function(e){t.$set(t.bundleInfo,"hash",e)},expression:"bundleInfo.hash"}}),e("b-input-group-form-input",{attrs:{id:"bundle-created","input-group-size":"mb-3",type:"text",value:t.bundleCreated,lazy:"true",feedback:"false",autofocus:"false",label:t.$t("message.created"),disabled:"true"}}),e("b-input-group-form-input",{attrs:{id:"bundle-last-sync",value:t.bundleLastSynced,feedback:"false",label:t.$t("message.policy_bundle_sync_timestamp"),disabled:"true"}})],1)],1)],1)],1)},Ue=[],Ye=n("f1fb"),Ve=n("8e5f"),Be=n.n(Ve),ze=n("c7a0"),Fe=n.n(ze);function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}var qe={name:"PolicyBundleInfoModal",mixins:[a["a"]],components:{BInputGroupFormInput:S["a"],VueTagsInput:Fe.a,BInputGroupFormSelect:A["a"],cSwitch:Ye["o"],Multiselect:Be.a},props:{bundleInfo:Object},data:function(){return{syncToken:{}}},computed:{bundleCreated:{get:function(){return"undefined"!==typeof this.bundleInfo.created&&null!=this.bundleInfo.created?l["a"].formatTimestamp(this.bundleInfo.created):"-"}},bundleLastSynced:{get:function(){return He(null!=this.bundleInfo.lastSuccessfulSync&&"number"===this.bundleInfo.lastSuccessfulSync)?l["a"].formatTimestamp(this.bundleInfo.lastSuccessfulSync,!0):"-"}}}},We=qe,Xe=(n("30a6"),n("cea2"),Object(b["a"])(We,De,Ue,!1,null,"60a9589a",null)),Je=Xe.exports,Qe=n("5c8a"),Ke=n("8992"),Ze={mixins:[a["a"],N["a"]],components:{PolicyBundleInfoModal:Je},methods:{cloneDeep:function(t){return Object(Qe["a"])(t)},apiUrl:function(){return"".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_VULNERABILITY_POLICY)},tableLoaded:function(t){t&&Object.prototype.hasOwnProperty.call(t,"total")?this.$emit("total",t.total):this.$emit("total","?")},refreshTable:function(){this.$refs.table.refresh({url:this.apiUrl(),silent:!0})},initializeTooltips:function(){je()('[data-toggle="tooltip"]').tooltip()},onLoadSuccess:function(){Object(Ke["e"])(this,"VulnerabilityPolicyList",this.$refs.table.columns)},sync:function(){var t=this,e="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_VULNERABILITY_POLICY,"/bundle/sync");this.axios.post(e).then((function(){return t.$toastr.s(t.$t("message.policy_bundle_sync_requested")),t.fetchBundleSyncStatus()})).catch((function(e){t.$toastr.w(e.response.data.message)}))},fetchBundleSyncStatus:function(){var t=this;this.axios.get("".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_WORKFLOW,"/token/").concat(this.bundleSyncToken,"/status")).then((function(e){if(e.data&&Array.isArray(e.data)){var n=e.data[0];if("POLICY_BUNDLE_SYNC"===n.step)return t.bundleSyncWorkflowState=n,t.bundleSyncStatus=n.status,"PENDING"!==t.bundleSyncStatus||t.bundleSyncStatusPollInterval?"PENDING"!==t.bundleSyncStatus&&(clearInterval(t.bundleSyncStatusPollInterval),t.bundleSyncStatusPollInterval=null):t.bundleSyncStatusPollInterval=setInterval(t.fetchBundleSyncStatus,1e3),n;console.log("Unexpected workflow step: ".concat(JSON.stringify(n)))}})).catch((function(t){if(t.response&&404===t.response.status)return Promise.resolve()})).then((function(e){return t.getBundleInfo(),"COMPLETED"===e.status&&t.refreshTable(),e}))},getBundleInfo:function(){var t=this,e="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_VULNERABILITY_POLICY,"/bundle");this.axios.get(e).then((function(e){t.bundleInfo=e.data})).catch((function(){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))}},mounted:function(){this.fetchBundleSyncStatus()},data:function(){var t=this;return{bundleSyncToken:"bc106cf4-3993-4e38-952d-d2f5f11412ed",bundleSyncStatus:null,bundleSyncWorkflowState:null,bundleSyncStatusPollInterval:null,bundleInfo:{},columns:[{title:this.$t("message.name"),field:"name",sortable:!0,formatter:function(t){return u.a.inHTMLData(l["a"].valueWithDefault(t,""))}},{title:this.$t("message.author"),field:"author",sortable:!0,formatter:function(t){return u.a.inHTMLData(l["a"].valueWithDefault(t,"-"))}},{title:this.$t("message.validFrom"),field:"validFrom",sortable:!0,formatter:function(t){return"undefined"!==typeof t&&null!=t?l["a"].formatTimestamp(Math.trunc(1e3*t)):"-"}},{title:this.$t("message.validUntil"),field:"validUntil",sortable:!0,formatter:function(t){return"undefined"!==typeof t&&null!=t?l["a"].formatTimestamp(Math.trunc(1e3*t)):"-"}},{title:this.$t("message.created"),field:"created",sortable:!0,formatter:function(t){return"undefined"!==typeof t&&null!=t?l["a"].formatTimestamp(Math.trunc(1e3*t)):"-"}},{title:this.$t("message.updated"),field:"updated",sortable:!0,formatter:function(t){return"undefined"!==typeof t&&null!=t?l["a"].formatTimestamp(Math.trunc(1e3*t)):"-"}},{title:this.$t("message.policy_operation_mode"),field:"operationMode",sortable:!0,formatter:function(t){return u.a.inHTMLData(l["a"].valueWithDefault(t,"-"))}}],data:[],options:{onPostBody:this.initializeTooltips,search:!0,showColumns:!0,showRefresh:!0,pagination:!0,silentSort:!1,sidePagination:"server",queryParamsType:"pageSize",pageList:"[10, 25, 50, 100]",pageSize:localStorage&&null!==localStorage.getItem("VulnerabilityPolicyListPageSize")?Number(localStorage.getItem("VulnerabilityPolicyListPageSize")):10,sortName:localStorage&&null!==localStorage.getItem("VulnerabilityPolicyListSortName")?localStorage.getItem("VulnerabilityPolicyListSortName"):void 0,sortOrder:localStorage&&null!==localStorage.getItem("VulnerabilityPolicyListSortOrder")?localStorage.getItem("VulnerabilityPolicyListSortOrder"):void 0,icons:{refresh:"fa-refresh"},detailView:!0,detailViewIcon:!1,detailViewByClick:!0,detailFormatter:function(e,n){return t.vueFormatter({i18n:E["a"],template:'\n                <b-row class="expanded-row">\n                  <b-col sm="6">\n                    <b-form-group id="fieldset-1" :label="this.$t(\'message.conditions\')" label-for="imput-1" disabled>\n                      <b-form-group v-for="condition in conditions">\n                        <MonacoEditor :readOnly="true" id="input-value" v-model="condition" :debounce-events="\'keyup\'"/>\n                      </b-form-group>\n                    </b-form-group>\n                      <b-form-group id="fieldset-2" :label="this.$t(\'message.ratings\')" label-for="input-2">\n                        <b-card>\n                          <b-input-group-form-input :label="this.$t(\'message.method\')" input-group-size="mb-3"\n                          required="false" v-model="this.rating_method" lazy="true" autofocus="true" disabled="true"/>\n                          <b-input-group-form-input :label="this.$t(\'message.severity\')" input-group-size="mb-3"\n                          required="false" v-model="this.rating_severity" lazy="true" autofocus="true" disabled="true"/>\n                          <b-input-group-form-input :label="this.$t(\'message.score\')" input-group-size="mb-3"\n                          required="false" v-model="this.rating_score" lazy="true" autofocus="true" disabled="true"/>\n                          <b-input-group-form-input :label="this.$t(\'message.vector\')" input-group-size="mb-3"\n                          required="false" v-model="this.rating_vector" lazy="true" autofocus="true" disabled="true"/>\n                        </b-card>\n                      </b-form-group>\n                  </b-col>\n                  <b-col sm="6">\n                    <b-form-group id="fieldset-1" :label="this.$t(\'message.description\')" label-for="input-1">\n                      <b-form-textarea rows="4" id="input-1" v-model="this.policy.description" disabled class="form-control disabled" trim />\n                    </b-form-group>\n                      <b-row>\n                        <b-col sm="6">\n                          <b-form-group id="fieldset-2" :label="this.$t(\'message.analysis\')" label-for="input-2" />\n                        </b-col>\n                        <b-col sm="6" align="right">\n                          <span v-if="this.analysis.suppress"><i class="fa fa-check-square-o" /></span>\n                          <span v-else><i class="fa fa-square-o" /></span>\n                            Suppressed\n                        </b-col>\n                      </b-row>\n                      <b-card>\n                      <b-form-group\n                          <b-input-group-form-input :label="this.$t(\'message.state\')" input-group-size="mb-3"\n                          required="false" v-model="this.analysis.state" lazy="true" autofocus="true" disabled="true"/>\n                          <b-input-group-form-input :label="this.$t(\'message.justification\')" input-group-size="mb-3"\n                          required="false" v-model="this.analysis.justification" lazy="true" autofocus="true" disabled="true"/>\n                          <b-input-group-form-input :label="this.$t(\'message.vendor_response\')" input-group-size="mb-3"\n                          required="false" v-model="this.analysis.vendorResponse" lazy="true" autofocus="true" disabled="true"/>\n                          <b-input-group-form-input :label="this.$t(\'message.details\')" input-group-size="mb-3"\n                          required="false" v-model="this.analysis.details" lazy="true" autofocus="true" disabled="true"/>\n                      </b-form-group>\n                    </b-card>\n                  </b-col>\n                </b-row>\n              ',data:function(){return{policy:n,conditions:n.conditions,rating_method:n.ratings&&null!=n.ratings[0]?n.ratings[0].method:null,rating_severity:n.ratings&&null!=n.ratings[0]?n.ratings[0].severity:null,rating_score:n.ratings&&null!=n.ratings[0]?n.ratings[0].score:null,rating_vector:n.ratings&&null!=n.ratings[0]?n.ratings[0].vector:null,analysis:n.analysis}},components:{BootstrapToggle:ke.a,BInputGroupFormInput:S["a"],MonacoEditor:Wt}})},onExpandRow:this.vueFormatterInit,toolbar:"#vulnerabilityPolicyToolbar",responseHandler:function(t,e){return t.total=e.getResponseHeader("X-Total-Count"),t},url:this.apiUrl(),onPageChange:function(t,e){localStorage&&localStorage.setItem("VulnerabilityPolicyListPageSize",e.toString())},onColumnSwitch:function(t,e){localStorage&&localStorage.setItem("VulnerabilityPolicyListShow"+l["a"].capitalize(t),e.toString())},onSort:function(t,e){localStorage&&(localStorage.setItem("VulnerabilityPolicyListSortName",t),localStorage.setItem("VulnerabilityPolicyListSortOrder",e))}}}}},tn=Ze,en=Object(b["a"])(tn,we,Re,!1,null,null,null),nn=en.exports,on={mixins:[a["a"]],components:{LicenseGroupList:Me,PolicyList:he,VulnerabilityPolicyList:nn},data:function(){return{totalPolicies:0,totalLicenseGroups:0,totalVulnerabilityPolicies:0}},methods:{routeTo:function(t){t?this.$route.fullPath.toLowerCase().includes("/"+t.toLowerCase())||this.$router.push({path:"/policy/"+t}):"/policy"!==this.$route.fullPath&&"/policy/"!==this.$route.fullPath&&this.$router.push({path:"/policy"})},getTabFromRoute:function(){var t=new RegExp("/policy/([^\\/]*)","gi"),e=t.exec(this.$route.fullPath.toLowerCase());return this.$refs[e&&e[1]?e[1].toLowerCase():"policies"]}},mounted:function(){var t=this.getTabFromRoute();t&&(t.active=!0)},watch:{$route:function(){var t=this.getTabFromRoute();t&&t.activate()}}},an=on,rn=Object(b["a"])(an,o,i,!1,null,null,null);e["default"]=rn.exports},"7c15":function(t,e,n){"use strict";var o=n("a4c1");function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,r=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function a(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}e["a"]={data:function(){return{PERMISSIONS:{BOM_UPLOAD:o["f"],VIEW_PORTFOLIO:o["A"],PORTFOLIO_MANAGEMENT:o["m"],PORTFOLIO_MANAGEMENT_CREATE:o["n"],PORTFOLIO_MANAGEMENT_READ:o["p"],PORTFOLIO_MANAGEMENT_UPDATE:o["q"],PORTFOLIO_MANAGEMENT_DELETE:o["o"],VIEW_VULNERABILITY:o["B"],VULNERABILITY_ANALYSIS:o["C"],VULNERABILITY_ANALYSIS_CREATE:o["D"],VULNERABILITY_ANALYSIS_READ:o["E"],VULNERABILITY_ANALYSIS_UPDATE:o["F"],VIEW_POLICY_VIOLATION:o["z"],VULNERABILITY_MANAGEMENT:o["G"],VULNERABILITY_MANAGEMENT_CREATE:o["H"],VULNERABILITY_MANAGEMENT_READ:o["J"],VULNERABILITY_MANAGEMENT_UPDATE:o["K"],VULNERABILITY_MANAGEMENT_DELETE:o["I"],POLICY_VIOLATION_ANALYSIS:o["l"],ACCESS_MANAGEMENT:o["a"],ACCESS_MANAGEMENT_CREATE:o["b"],ACCESS_MANAGEMENT_READ:o["d"],ACCESS_MANAGEMENT_UPDATE:o["e"],ACCESS_MANAGEMENT_DELETE:o["c"],SYSTEM_CONFIGURATION:o["s"],SYSTEM_CONFIGURATION_CREATE:o["t"],SYSTEM_CONFIGURATION_READ:o["v"],SYSTEM_CONFIGURATION_UPDATE:o["w"],SYSTEM_CONFIGURATION_DELETE:o["u"],PROJECT_CREATION_UPLOAD:o["r"],POLICY_MANAGEMENT:o["g"],POLICY_MANAGEMENT_CREATE:o["h"],POLICY_MANAGEMENT_READ:o["j"],POLICY_MANAGEMENT_UPDATE:o["k"],POLICY_MANAGEMENT_DELETE:o["i"],TAG_MANAGEMENT:o["x"],TAG_MANAGEMENT_DELETE:o["y"]}}},computed:{decodedToken:function(){return o["L"](o["M"]())}},methods:{isPermitted:function(t){if("string"==typeof t)return o["N"](t,this.decodedToken);if(Array.isArray(t)){var e,n=i(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(o["N"](a,this.decodedToken))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}throw new Error("permission must be of type string or array")},isNotPermitted:function(t){if("string"==typeof t)return!o["N"](t,this.decodedToken);if(Array.isArray(t)){var e,n=i(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(o["N"](a,this.decodedToken))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}throw new Error("permission must be of type string or array")}}}},"847e":function(t,e,n){"use strict";n("c02e")},"8b7e":function(t,e,n){},"973e":function(t,e,n){},c02e:function(t,e,n){},cc9d:function(t,e,n){"use strict";var o=function(){var t=this,e=t._self._c;return e("validation-provider",{attrs:{vid:t.id,name:t.label,rules:t.rules,mode:t.mode},scopedSlots:t._u([{key:"default",fn:function(n){var o=n.errors,i=n.valid;return[e("b-form-group",{attrs:{id:t.id,label:t.label,"label-for":"".concat(t.id,"-input")}},[e("b-input-group",{class:t.inputGroupSize},[t.icon?e("b-input-group-prepend",[e("b-input-group-text",[e("i",{class:t.icon})])],1):t._e(),e("b-form-input",t._g({class:t.inputClasses,attrs:{id:"".concat(t.id,"-input"),type:t.type,placeholder:t.label,state:t.errorHandlingMethod(o,i),autocomplete:t.autocomplete,autofocus:t.isFocused},model:{value:t.innerValue,callback:function(e){t.innerValue=e},expression:"innerValue"}},t.inputListeners)),t.tooltip?e("b-input-group-append",[e("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.tooltip}},[e("i",{staticClass:"cui-info font-lg"})])],1):t._e()],1),e("b-form-invalid-feedback",{attrs:{state:t.errorHandlingMethod(o,i)}},[t._v("\n      "+t._s(o[0])+"\n    ")])],1)]}}])})},i=[],a=n("7bb1"),r=n("900c"),s={name:"BValidatedInputGroupFormInput",components:{ValidationProvider:a["b"]},props:{id:String,label:String,value:String,inputGroupSize:String,icon:String,rules:String,mode:String,type:String,autocomplete:String,autofocus:String,tooltip:String,lazy:String},data:function(){return{isFocused:!1}},beforeMount:function(){!0!==this.autofocus&&"true"!==this.autofocus||(this.isFocused=!0)},computed:{innerValue:{get:function(){return this.value},set:function(t){return t}},inputListeners:function(){var t=this;return Object.assign({},this.$listeners,{input:function(e){t.$emit("input",e)}})},inputClasses:function(){var t="form-control";return!r["a"].toBoolean(this.lazy)&&this.rules&&this.rules.includes("required")&&(t+=" required"),t}},methods:{errorHandlingMethod:function(t,e){return this.rules?r["a"].toBoolean(this.lazy)?!t[0]&&(!!e||null):!t[0]&&!!e:null}}},l=s,c=n("2877"),u=Object(c["a"])(l,o,i,!1,null,null,null);e["a"]=u.exports},cea2:function(t,e,n){"use strict";n("973e")},e68f:function(t,e,n){"use strict";var o=function(){var t=this,e=t._self._c;return e("li",{staticClass:"list-group-item align-middle"},[e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"pull-right action-icon",attrs:{size:"sm",title:t.tooltip},on:{click:function(e){return t.$emit("actionClicked")}}},[this.addIcon?e("span",{staticClass:"fa fa-plus-square"}):t._e(),this.deleteIcon?e("span",{staticClass:"fa fa-trash-o"}):t._e()]),t.$slots&&t.$slots.default&&t.$slots.default[0]?t._t("default"):e("span",[this.href?e("a",{attrs:{href:t.href}},[t._v(t._s(t.value))]):e("span",[t._v(t._s(t.value))]),t._v(" ")])],2)},i=[],a={props:{value:String,tooltip:String,addIcon:Boolean,deleteIcon:Boolean,variant:String,href:String}},r=a,s=(n("847e"),n("2877")),l=Object(s["a"])(r,o,i,!1,null,"683f4500",null);e["a"]=l.exports},f307:function(t,e,n){"use strict";var o=function(){var t=this,e=t._self._c;return e("b-modal",{directives:[{name:"permission",rawName:"v-permission",value:"VIEW_PORTFOLIO",expression:"'VIEW_PORTFOLIO'"}],attrs:{id:"selectProjectModal",size:"lg","hide-header-close":"","no-stacking":"",title:t.$t("message.select_project")},scopedSlots:t._u([{key:"modal-footer",fn:function(n){var o=n.cancel;return[e("b-button",{attrs:{size:"md",variant:"secondary"},on:{click:function(t){return o()}}},[t._v(t._s(t.$t("message.cancel")))]),e("b-button",{attrs:{size:"md",variant:"primary"},on:{click:t.handleSelection}},[t._v(t._s(t.$t("message.select")))])]}}])},[e("bootstrap-table",{ref:"table",attrs:{columns:t.columns,data:t.data,options:t.options}})],1)},i=[],a=n("6c36"),r=n.n(a),s=n("7c15"),l=n("900c"),c={mixins:[s["a"]],props:{username:{type:String,default:null}},methods:{apiUrl:function(){var t="";return this.username?(t="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_ACL_USER,"/").concat(this.username),t):(t="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_PROJECT),void 0===this.showInactiveProjects?t+="?excludeInactive=true":t+="?excludeInactive="+!this.showInactiveProjects,t)},refreshTable:function(){this.$refs.table.refresh({url:this.apiUrl(),pageNumber:1,silent:!0})},handleSelection:function(){this.$root.$emit("bv::hide::modal",this.$children[0].id),this.$emit("selection",this.$refs.table.getSelections())}},watch:{showInactiveProjects:function(){this.refreshTable()}},data:function(){return{showInactiveProjects:!1,labelIcon:{dataOn:"✓",dataOff:"✕"},columns:[{field:"state",checkbox:!0,align:"center"},{title:this.$t("message.project_name"),field:"name",sortable:!0,formatter:function(t){return r.a.inHTMLData(l["a"].valueWithDefault(t,""))}},{title:this.$t("message.version"),field:"version",sortable:!0,formatter:function(t){return r.a.inHTMLData(l["a"].valueWithDefault(t,""))}},{title:this.$t("message.active"),field:"active",formatter:function(t){return!0===t?'<i class="fa fa-check-square-o" />':""},align:"center",class:"tight",sortable:!0}],data:[],options:{search:!0,showColumns:!0,showRefresh:!0,pagination:!0,silentSort:!1,sidePagination:"server",queryParamsType:"pageSize",pageList:"[10, 25, 50, 100]",pageSize:10,icons:{refresh:"fa-refresh"},toolbar:"#projectsToolbar",responseHandler:function(t,e){return t.total=e.getResponseHeader("X-Total-Count"),t},url:this.apiUrl()}}}},u=c,d=n("2877"),p=Object(d["a"])(u,o,i,!1,null,null,null);e["a"]=p.exports}}]);